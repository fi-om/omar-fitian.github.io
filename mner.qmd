---
title: "Minnesota Nonprofit Economic Snapshot: A Mini-Analysis"
editor_options: 
  chunk_output_type: console
execute:
  echo: false
toc: false
---

```{r, include = FALSE}
library(tidyverse)
```

**This sample was prepared as a work sample for MCN.**

# Executive Summary

-   The nonprofit sector remains a significant contributor to Minnesota's economy, employing approximately 13% of the state's workforce.
-   Nonprofit employment has shown steady growth over the past three decades, increasing by over 120% compared to a 30% growth in the total state workforce.
-   The nonprofit workforce is predominantly female (74% of employees).
-   Wages in the nonprofit sector, though traditionally lower, have shown resilience and are increasingly competitive with government wages.
-   Regional distribution of nonprofit employers mirrors population trends, with the Twin Cities Metro being the central hub.

# Introduction

This analysis uses nonprofit-adjacent industries (Education, Healthcare, Arts, and Other Services) as a proxy for the nonprofit sector, based on publicly available QCEW data from 2023. In some sections, to demonstrate statistical inference methods, I simulated individual-level wage data around the reported sector averages.

```{r}
qcewGetAreaData <- function(year, qtr, area) {
	url <- "http://data.bls.gov/cew/data/api/YEAR/QTR/area/AREA.csv"
	url <- sub("YEAR", year, url, ignore.case=FALSE)
	url <- sub("QTR", tolower(qtr), url, ignore.case=FALSE)
	url <- sub("AREA", toupper(area), url, ignore.case=FALSE)
	read.csv(url, header = TRUE, sep = ",", quote="\"", dec=".", na.strings=" ", skip=0)
}

mn_data_2023 <- qcewGetAreaData("2023", "a", "27000")

mn_nonprofit_like <- mn_data_2023 %>%
  filter(own_code == 5, industry_code %in% c("61", "62", "71", "81")) %>%
  mutate(industry_title = case_when(
    industry_code == "61" ~ "Educational Services",
    industry_code == "62" ~ "Health Care & Social Assistance",
    industry_code == "71" ~ "Arts, Entertainment, Recreation",
    industry_code == "81" ~ "Other Services"
  ))

```

# Exploratory Data Analysis

Although statistical inference is not possible due to the aggregated nature of the data, visual inspection suggests that average annual wages and employment differ meaningfully across nonprofit-adjacent sectors.

```{r}
#| label: fig-bar-employment
#| fig-cap: "The healthcare industry has the highest number of employees, and the Arts industry employs the least."

ggplot(mn_nonprofit_like, aes(x = industry_title, y = annual_avg_emplvl)) +
  geom_col(fill = "steelblue") +
  labs(title = "Nonprofit-Adjacent Employment in Minnesota (2023)", x = "Industry", y = "Employees",
       caption = "Source: DEED 2023")
```

```{r}
set.seed(123)

health_wages <- rnorm(100, mean = 65000, sd = 8000)
education_wages <- rnorm(100, mean = 50000, sd = 7000)
arts_wages <- rnorm(100, mean = 38000, sd = 6000)
other_services_wages <- rnorm(100, mean = 45000, sd = 6500)

simulated_data <- data.frame(
  wage = c(health_wages, education_wages, arts_wages, other_services_wages),
  sector = factor(rep(c("Health Care", "Education", "Arts", "Other Services"), each = 100))
)

anova_sim <- aov(wage ~ sector, data = simulated_data)
summary(anova_sim)

TukeyHSD(anova_sim)
```




```{r}
#| label: fig-bar-wages
#| fig-cap: "The healthcare industry has the highest annual wage, with the other industries having similar wages."

ggplot(mn_nonprofit_like, aes(x = industry_title, y = annual_avg_wkly_wage * 52)) +
  geom_col(fill = "seagreen") +
  labs(title = "Estimated Annual Wages by Industry (2023)", x = "Industry", y = "Annual Wages (USD)",
       caption = "Source: DEED 2023") 
```
